{% extends "base.html" %}
{% block title %}Performance - Gap Trader{% endblock %}
{% block content %}
<h1 data-testid="page-title">Performance</h1>
<p class="text-muted mb-4">Track your gap trading performance over time.</p>

<!-- Summary Cards -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Total Trades</h6>
                <h3 data-testid="stats-total-trades" id="statsTotalTrades">-</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Win Rate</h6>
                <h3 data-testid="stats-win-rate" id="statsWinRate">-</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Total P&amp;L</h6>
                <h3 data-testid="stats-total-pnl" id="statsTotalPnl">-</h3>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Profit Factor</h6>
                <h3 data-testid="stats-profit-factor" id="statsProfitFactor">-</h3>
            </div>
        </div>
    </div>
</div>

<!-- Secondary stats -->
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Best Trade</h6>
                <h4 data-testid="stats-best-trade" id="statsBestTrade">-</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Worst Trade</h6>
                <h4 data-testid="stats-worst-trade" id="statsWorstTrade">-</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Avg Winner</h6>
                <h4 id="statsAvgWinner">-</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-center">
            <div class="card-body">
                <h6 class="card-subtitle mb-2 text-muted">Avg Loser</h6>
                <h4 id="statsAvgLoser">-</h4>
            </div>
        </div>
    </div>
</div>

<!-- Period filter -->
<div class="row mb-3">
    <div class="col-md-3">
        <select class="form-select" id="periodFilter" data-testid="stats-period-filter">
            <option value="30">Last 30 Days</option>
            <option value="60">Last 60 Days</option>
            <option value="90">Last 90 Days</option>
            <option value="365">Last Year</option>
        </select>
    </div>
</div>

<!-- Charts -->
<div class="row mb-4">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <h5>Cumulative P&amp;L</h5>
                <canvas id="cumulativePnlChart" data-testid="chart-cumulative-pnl"></canvas>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5>Gap Type Performance</h5>
                <canvas id="gapTypeChart" data-testid="chart-gap-type"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h5>Daily P&amp;L</h5>
                <canvas id="dailyPnlChart" data-testid="chart-daily-pnl"></canvas>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/performance.js') }}"></script>
{% endblock %}
